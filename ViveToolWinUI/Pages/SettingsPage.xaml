<Page
    x:Class="ViveToolWinUI.Pages.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:muxc="using:Microsoft.UI.Xaml.Controls">

    <ScrollViewer Padding="15" VerticalScrollBarVisibility="Auto">
        <StackPanel Spacing="32" HorizontalAlignment="Stretch">

            <!-- 外观与材质组 -->
            <StackPanel Spacing="12" HorizontalAlignment="Stretch">
                <!-- AppearanceGroup.Text -->
                <TextBlock x:Uid="AppearanceGroup" x:Name="AppearanceGroupText" FontSize="20" FontWeight="SemiBold" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>

                <!-- 应用主题折叠卡 -->
                <muxc:Expander x:Name="ThemeExpander" IsExpanded="False" HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" MinHeight="70">
                    <muxc:Expander.Header>
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <FontIcon Glyph="&#xE706;" Width="30" FontSize="20" VerticalAlignment="Center"/>
                            <StackPanel>
                                <!-- ThemeHeader.Title.Text / ThemeHeader.Subtitle.Text -->
                                <TextBlock x:Uid="ThemeHeader.Title" x:Name="ThemeHeaderTitle" FontSize="16" FontWeight="SemiBold" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                                <TextBlock x:Uid="ThemeHeader.Subtitle" x:Name="ThemeHeaderSubtitle" FontSize="12" Opacity="0.7" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            </StackPanel>
                        </StackPanel>
                    </muxc:Expander.Header>
                    <muxc:Expander.Content>
                        <StackPanel Spacing="8" Padding="12,0,0,12" HorizontalAlignment="Left">
                            <RadioButton x:Name="ThemeSystem" Checked="Theme_Checked" Tag="System">
                                <TextBlock x:Uid="ThemeSystem" x:Name="ThemeSystemText" TextWrapping="Wrap" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            </RadioButton>
                            <RadioButton x:Name="ThemeLight" Checked="Theme_Checked" Tag="Light">
                                <TextBlock x:Uid="ThemeLight" x:Name="ThemeLightText" TextWrapping="Wrap" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            </RadioButton>
                            <RadioButton x:Name="ThemeDark" Checked="Theme_Checked" Tag="Dark">
                                <TextBlock x:Uid="ThemeDark" x:Name="ThemeDarkText" TextWrapping="Wrap" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            </RadioButton>
                        </StackPanel>
                    </muxc:Expander.Content>
                </muxc:Expander>

                <!-- 背景材质折叠卡 -->
                <muxc:Expander x:Name="MaterialExpander" IsExpanded="False" HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" MinHeight="70">
                    <muxc:Expander.Header>
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <FontIcon Glyph="&#xE2B1;" Width="30" FontSize="20" VerticalAlignment="Center"/>
                            <StackPanel>
                                <!-- MaterialHeader.Title / MaterialHeader.Subtitle -->
                                <TextBlock x:Uid="MaterialHeader.Title" x:Name="MaterialHeaderTitle" FontSize="16" FontWeight="SemiBold" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                                <TextBlock x:Uid="MaterialHeader.Subtitle" x:Name="MaterialHeaderSubtitle" FontSize="12" Opacity="0.7" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            </StackPanel>
                        </StackPanel>
                    </muxc:Expander.Header>
                    <muxc:Expander.Content>
                        <StackPanel Spacing="8" Padding="12,0,0,12" HorizontalAlignment="Left">
                            <RadioButton x:Name="MaterialAcrylic" Checked="Material_Checked" Tag="Acrylic">
                                <TextBlock x:Uid="MaterialAcrylic" x:Name="MaterialAcrylicText" TextWrapping="Wrap" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            </RadioButton>
                            <RadioButton x:Name="MaterialMica" Checked="Material_Checked" Tag="Mica">
                                <TextBlock x:Uid="MaterialMica" x:Name="MaterialMicaText" TextWrapping="Wrap" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            </RadioButton>
                            <RadioButton x:Name="MaterialMicaAlt" Checked="Material_Checked" Tag="MicaAlt">
                                <TextBlock x:Uid="MaterialMicaAlt" x:Name="MaterialMicaAltText" TextWrapping="Wrap" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            </RadioButton>
                        </StackPanel>
                    </muxc:Expander.Content>
                </muxc:Expander>
            </StackPanel>

            <!-- ViveTool 内核 / 行为 -->
            <StackPanel Spacing="12" HorizontalAlignment="Stretch">
                <!-- BehaviorGroup.Text -->
                <TextBlock x:Uid="BehaviorGroup" x:Name="BehaviorGroupText" FontSize="20" FontWeight="SemiBold" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>

                <!-- 内核管理折叠卡 -->
                <muxc:Expander x:Name="KernelExpander" IsExpanded="True" HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" MinHeight="70">
                    <muxc:Expander.Header>
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <FontIcon Glyph="&#xE9D9;" Width="30" FontSize="20" VerticalAlignment="Center"/>
                            <StackPanel>
                                <!-- KernelHeader.Title / KernelHeader.Subtitle -->
                                <TextBlock x:Uid="KernelHeader.Title" x:Name="KernelHeaderTitle" FontSize="16" FontWeight="SemiBold" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                                <TextBlock x:Uid="KernelHeader.Subtitle" x:Name="KernelHeaderSubtitle" FontSize="12" Opacity="0.7" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            </StackPanel>
                        </StackPanel>
                    </muxc:Expander.Header>
                    <muxc:Expander.Content>
                        <StackPanel Spacing="8" Padding="12,0,0,12" HorizontalAlignment="Left">
                            <!-- Use a wrap-capable panel so buttons flow to next line when space is limited -->
                            <VariableSizedWrapGrid Orientation="Horizontal" Margin="0,0,0,8" HorizontalAlignment="Left">
                                <Button x:Name="BtnCheckViveToolUpdate" Click="CheckViveToolUpdate_Click" Width="120" Margin="6,6,6,6" HorizontalContentAlignment="Left">
                                    <TextBlock x:Uid="BtnCheckViveToolUpdate" x:Name="BtnCheckViveToolUpdateText" TextWrapping="Wrap" TextAlignment="Left" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                                </Button>
                                <Button x:Name="BtnCustomUpdateLink" Click="CustomUpdateLink_Click" Width="160" Margin="6,6,6,6" HorizontalContentAlignment="Left">
                                    <TextBlock x:Uid="BtnCustomUpdateLink" x:Name="BtnCustomUpdateLinkText" TextWrapping="Wrap" TextAlignment="Left" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                                </Button>
                                <Button x:Name="BtnImportKernelZip" Click="ImportKernelZip_Click" Width="160" Margin="6,6,6,6" HorizontalContentAlignment="Left">
                                    <TextBlock x:Uid="BtnImportKernelZip" x:Name="BtnImportKernelZipText" TextWrapping="Wrap" TextAlignment="Left" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                                </Button>
                                <Button x:Name="BtnOpenCoreFolder" Click="BtnOpenCoreFolder_Click" Width="160" Margin="6,6,6,6" HorizontalContentAlignment="Left">
                                    <TextBlock x:Uid="BtnOpenCoreFolder" x:Name="BtnOpenCoreFolderText" TextWrapping="Wrap" TextAlignment="Left" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                                </Button>
                                <Button x:Name="BtnBackupCore" Click="BtnBackupCore_Click" Width="160" Margin="6,6,6,6" HorizontalContentAlignment="Left">
                                    <TextBlock x:Uid="BtnBackupCore" x:Name="BtnBackupCoreText" TextWrapping="Wrap" TextAlignment="Left" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                                </Button>
                                <Button x:Name="BtnRestoreCore" Click="BtnRestoreCore_Click" Width="160" Margin="6,6,6,6" HorizontalContentAlignment="Left">
                                    <TextBlock x:Uid="BtnRestoreCore" x:Name="BtnRestoreCoreText" TextWrapping="Wrap" TextAlignment="Left" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                                </Button>
                            </VariableSizedWrapGrid>
                        </StackPanel>
                    </muxc:Expander.Content>
                </muxc:Expander>

                <StackPanel Orientation="Horizontal" Spacing="12" Margin="0,0,0,8"/>

                <VariableSizedWrapGrid Orientation="Horizontal" Margin="0,0,0,8" HorizontalAlignment="Left">
                    <Button x:Name="BtnExportSettings" Click="BtnExportSettings_Click" Width="160" Margin="6,6,6,6" HorizontalContentAlignment="Left">
                        <TextBlock x:Uid="BtnExportSettings" x:Name="BtnExportSettingsText" TextWrapping="Wrap" TextAlignment="Left" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                    </Button>
                    <Button x:Name="BtnImportSettings" Click="BtnImportSettings_Click" Width="160" Margin="6,6,6,6" HorizontalContentAlignment="Left">
                        <TextBlock x:Uid="BtnImportSettings" x:Name="BtnImportSettingsText" TextWrapping="Wrap" TextAlignment="Left" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                    </Button>
                    <Button x:Name="BtnResetSettings" Click="BtnResetSettings_Click" Width="120" Margin="6,6,6,6" HorizontalContentAlignment="Left">
                        <TextBlock x:Uid="BtnResetSettings" x:Name="BtnResetSettingsText" TextWrapping="Wrap" TextAlignment="Left" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                    </Button>
                </VariableSizedWrapGrid>

                <VariableSizedWrapGrid Orientation="Horizontal" Margin="0,0,0,8" HorizontalAlignment="Left">
                    <Button x:Name="BtnTestViveTool" Click="BtnTestViveTool_Click" Width="160" Margin="6,6,6,6" HorizontalContentAlignment="Left">
                        <TextBlock x:Uid="BtnTestViveTool" x:Name="BtnTestViveToolText" TextWrapping="Wrap" TextAlignment="Left" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                    </Button>
                </VariableSizedWrapGrid>

                <!-- ToggleSwitch Header 用子元素 TextBlock -->
                <muxc:ToggleSwitch x:Name="AutoUpdateViveToolToggle" Toggled="AutoUpdateViveToolToggle_Toggled" Margin="0,8,0,0">
                    <muxc:ToggleSwitch.Header>
                        <TextBlock x:Uid="AutoUpdateViveToolToggleHeader" x:Name="AutoUpdateToggleHeaderText" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                    </muxc:ToggleSwitch.Header>
                </muxc:ToggleSwitch>
            </StackPanel>

            <!-- 关于 -->
            <StackPanel Spacing="12" HorizontalAlignment="Stretch">
                <!-- AboutTitle.Text -->
                <TextBlock x:Uid="AboutTitle" x:Name="AboutTitleText" FontSize="20" FontWeight="SemiBold" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                <muxc:Expander x:Name="AboutExpander" IsExpanded="False" HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" MinHeight="100">
                    <muxc:Expander.Header>
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <!-- 优先使用 Image 加载 Assets/StoreLogo，FontIcon作为回退 -->
                            <Image x:Name="AppLogoImage" Width="30" Height="30" Stretch="UniformToFill" VerticalAlignment="Center" Visibility="Collapsed" Margin="0"/>
                            <FontIcon x:Name="AppLogo" Glyph="&#xE7C1;" Width="30" FontSize="20" VerticalAlignment="Center"/>
                            <StackPanel>
                                <TextBlock x:Uid="AppTitle" x:Name="AppTitle" FontSize="18" FontWeight="SemiBold" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                                <TextBlock x:Uid="AppPublisher" x:Name="AppPublisher" FontSize="12" Opacity="0.7" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                                <TextBlock x:Uid="AppVersion" x:Name="AppVersion" FontSize="12" Opacity="0.7" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            </StackPanel>
                        </StackPanel>
                    </muxc:Expander.Header>
                    <muxc:Expander.Content>
                        <StackPanel Spacing="8" Padding="12,0,0,12" HorizontalAlignment="Left">
                            <HyperlinkButton x:Name="JoinQQButton" HorizontalAlignment="Left">
                                <TextBlock x:Uid="JoinQQButton" x:Name="JoinQQButtonText" TextWrapping="Wrap" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            </HyperlinkButton>
                            <HyperlinkButton x:Name="JoinDiscordButton" HorizontalAlignment="Left">
                                <TextBlock x:Uid="JoinDiscordButton" x:Name="JoinDiscordButtonText" TextWrapping="Wrap" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            </HyperlinkButton>
                        </StackPanel>
                    </muxc:Expander.Content>
                </muxc:Expander>
            </StackPanel>

            <HyperlinkButton x:Name="FeedbackButton" Click="SendFeedback_Click" HorizontalAlignment="Left">
                <TextBlock x:Uid="FeedbackButton" x:Name="FeedbackButtonText" TextWrapping="Wrap" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
            </HyperlinkButton>
        </StackPanel>
    </ScrollViewer>
</Page>